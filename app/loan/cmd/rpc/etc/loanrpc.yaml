# Loan RPC 服务配置
Name: loanrpc.rpc
ListenOn: 0.0.0.0:20003

# Consul 服务注册配置
# 作用：将本服务注册到 Consul，以便其他服务可以发现并调用
Consul:
  Host: consul.huinong.internal
  Key: loanrpc.rpc
  Token: "331c00f9-bd87-2383-4394-548a0e66dea9"

# 链路追踪配置
Telemetry:
  Name: loanrpc
  Endpoint: http://127.0.0.1:14268/api/traces
  Sampler: 1.0
  Batcher: jaeger

# MySQL 数据库配置
# 数据库：loan，用户名：loan，密码：loan
MySQL:
  DataSource: loan:loan@tcp(10.10.10.6:3306)/loan?charset=utf8mb4&parseTime=true&loc=Asia%2FShanghai

# Redis 缓存配置
# 作用：go-zero model 自动使用 redis 缓存高频查询 (如 FindOne)，提升性能
CacheConf:
  - Host: 10.10.10.6:6379
    Type: node
    Pass: "ChinaSkills@"

# RPC客户端配置 - go-zero标准方式 + 懒加载 + 熔断优化
# 模式：服务发现模式 (推荐：测试 / 生产环境 / K8s 分离部署)
# 理由：支持 RPC 服务水平扩展、负载均衡和故障转移，是标准的生产级配置
# 注意：客户端的服务发现配置使用 Target URL 格式，而不是结构化配置
AppUserRpc:
  Target: consul://consul.huinong.internal/appuserrpc.rpc
  Lazy: true            # 懒加载：避免启动时因依赖服务未就绪而失败
  Timeout: 5000         # 调用超时：避免长时间等待 (毫秒)
  KeepaliveTime: 30s    # 保活时间：减少连接重建开销
  NonBlock: true        # 非阻塞：启动时不等待连接建立

LoanProductRpc:
  Target: consul://consul.huinong.internal/loanproductrpc.rpc
  Lazy: true            # 懒加载：避免启动时因依赖服务未就绪而失败
  Timeout: 5000         # 调用超时：避免长时间等待 (毫秒)
  KeepaliveTime: 30s    # 保活时间：减少连接重建开销
  NonBlock: true        # 非阻塞：启动时不等待连接建立

# 日志配置
Log:
  ServiceName: loanrpc
  Mode: file # 本地开发记入文件，K8s中应使用 console
  Path: logs
  Level: info
  KeepDays: 7
  Compress: true
